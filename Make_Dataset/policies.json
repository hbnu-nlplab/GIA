{
    "version": "2.0",
    "description": "네트워크 설정 검증 메트릭 정책 - L1~L5 레벨 체계",
    "level_definitions": {
        "L1": "단일 장비 설정값 조회 (Single Device Query)",
        "L2": "복수 장비 설정값 집계 (Multi-Device Aggregation)",
        "L3": "복수 장비 + 계산/검증 (Multi-Device + Computation)",
        "L4": "네트워크 흐름 도달성 - Batfish (Reachability Analysis)",
        "L5": "What-If / Differential 분석 - Batfish (Impact Analysis)"
    },
    "defaults": {
        "scenarios": [
            "보안 설정 점검",
            "라우팅 구성 검증",
            "VRF/RT 구성 확인",
            "L2VPN 일관성 확인",
            "OSPF 영역/이웃 가시성 확인",
            "시스템/접속 기본 정보 점검"
        ]

    },
    "policies": [
        {
            "category": "System_Inventory",
            "description": "시스템 기본 정보 조회",
            "levels": {
                "L1": [
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "system_hostname_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "system_version_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "system_timezone_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "system_user_list"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "system_user_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "logging_buffered_severity_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "ntp_server_list",
                        "notes": "NTP 서버 설정 확인"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "snmp_community_list",
                        "notes": "SNMP 커뮤니티 목록"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "syslog_server_list",
                        "notes": "Syslog 서버 목록"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "interface_status_map",
                        "notes": "인터페이스 상태 맵"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "routing_table_entry_count",
                        "notes": "라우팅 테이블 엔트리 수"
                    }
                ]
            }
        },
        {
            "category": "Security_Inventory",
            "description": "보안 설정 정보 조회",
            "levels": {
                "L1": [
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "ssh_present_bool"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "ssh_version_text"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "aaa_present_bool"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "vty_transport_input_text",
                        "notes": "VTY 접속 프로토콜 확인 (SSH/Telnet)"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "vty_login_mode_text",
                        "notes": "VTY 인증 방식 확인"
                    }
                ]
            }
        },
        {
            "category": "Interface_Inventory",
            "description": "인터페이스 정보 조회",
            "levels": {
                "L1": [
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "interface_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "interface_ip_map"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "subinterface_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "vrf_bind_map"
                    }
                ]
            }
        },
        {
            "category": "Routing_Inventory",
            "description": "라우팅 정보 조회",
            "levels": {
                "L1": [
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "bgp_local_as_numeric"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "bgp_neighbor_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "neighbor_list_ibgp"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "neighbor_list_ebgp"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "ospf_process_ids_set"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "ospf_area_set"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "ospf_area0_if_list"
                    }
                ]
            }
        },
        {
            "category": "Services_Inventory",
            "description": "서비스 설정 정보 조회",
            "levels": {
                "L1": [
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "vrf_names_set"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "vrf_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "vrf_rd_map"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "rt_import_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "rt_export_count"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "mpls_ldp_present_bool"
                    },
                    {
                        "goal": "extraction",
                        "targets": ["DEVICE"],
                        "primary_metric": "l2vpn_pw_id_set"
                    }
                ]
            }
        },
        {
            "category": "Security_Policy",
            "description": "보안 정책 준수 검증",
            "levels": {
                "L2": [
                    {
                        "goal": "compliance",
                        "targets": ["GLOBAL"],
                        "primary_metric": "ssh_enabled_devices"
                    },
                    {
                        "goal": "compliance",
                        "targets": ["GLOBAL"],
                        "primary_metric": "ssh_missing_devices"
                    },
                    {
                        "goal": "compliance",
                        "targets": ["GLOBAL"],
                        "primary_metric": "ssh_missing_count"
                    },
                    {
                        "goal": "compliance",
                        "targets": ["GLOBAL"],
                        "primary_metric": "aaa_enabled_devices"
                    },
                    {
                        "goal": "compliance",
                        "targets": ["GLOBAL"],
                        "primary_metric": "aaa_missing_devices"
                    },
                    {
                        "goal": "compliance",
                        "targets": ["GLOBAL"],
                        "primary_metric": "devices_with_same_vrf",
                        "notes": "동일 VRF를 사용하는 장비 그룹"
                    }
                ]
            }
        },
        {
            "category": "OSPF_Consistency",
            "description": "OSPF 구성 일관성 검증",
            "levels": {
                "L2": [
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "ospf_area_membership",
                        "notes": "특정 OSPF Area에 속한 장비 목록"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["DEVICE"],
                        "primary_metric": "ospf_area0_if_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["OSPF_AREA"],
                        "primary_metric": "ospf_neighbor_count_per_area",
                        "notes": "OSPF Area별 이웃 관계 수"
                    }
                ]
            }
        },
        {
            "category": "BGP_Consistency",
            "description": "BGP 구성 일관성 검증",
            "levels": {
                "L3": [
                    {
                        "goal": "consistency",
                        "targets": ["AS"],
                        "primary_metric": "ibgp_fullmesh_ok"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["AS"],
                        "primary_metric": "ibgp_missing_pairs"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["AS"],
                        "primary_metric": "ibgp_missing_pairs_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["AS"],
                        "primary_metric": "ibgp_under_peered_devices"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["AS"],
                        "primary_metric": "ibgp_under_peered_count"
                    }
                ]
            }
        },
        {
            "category": "VRF_Consistency",
            "description": "VRF 구성 일관성 검증",
            "levels": {
                "L3": [
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "vrf_without_rt_pairs"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "vrf_without_rt_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["DEVICE_VRF"],
                        "primary_metric": "vrf_interface_bind_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["DEVICE"],
                        "primary_metric": "vrf_rt_list_per_device"
                    }
                ]
            }
        },
        {
            "category": "L2VPN_Consistency",
            "description": "L2VPN 구성 일관성 검증",
            "levels": {
                "L2": [
                    {
                        "goal": "visibility",
                        "targets": ["GLOBAL"],
                        "primary_metric": "l2vpn_pairs"
                    }
                ],
                "L3": [
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "l2vpn_unidirectional_pairs"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "l2vpn_unidir_count"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "l2vpn_pwid_mismatch_pairs"
                    },
                    {
                        "goal": "consistency",
                        "targets": ["GLOBAL"],
                        "primary_metric": "l2vpn_mismatch_count"
                    }
                ]
            }
        },
        {
            "category": "Comparison_Analysis",
            "description": "장비 간 설정 비교 분석",
            "levels": {
                "L3": [
                    {
                        "goal": "comparison",
                        "targets": ["DEVICE_PAIR"],
                        "primary_metric": "compare_bgp_neighbor_count",
                        "notes": "두 장비의 BGP 피어 수 차이"
                    },
                    {
                        "goal": "comparison",
                        "targets": ["DEVICE_PAIR"],
                        "primary_metric": "compare_interface_count",
                        "notes": "두 장비의 인터페이스 수 차이"
                    },
                    {
                        "goal": "comparison",
                        "targets": ["DEVICE_PAIR"],
                        "primary_metric": "compare_vrf_count",
                        "notes": "두 장비의 VRF 수 차이"
                    },
                    {
                        "goal": "comparison",
                        "targets": ["DEVICE_PAIR"],
                        "primary_metric": "compare_bgp_as",
                        "notes": "두 장비가 같은 AS에 속하는지 확인"
                    },
                    {
                        "goal": "comparison",
                        "targets": ["DEVICE_PAIR"],
                        "primary_metric": "compare_ospf_areas",
                        "notes": "두 장비의 OSPF Area 참여 비교"
                    },
                    {
                        "goal": "aggregation",
                        "targets": ["GLOBAL"],
                        "primary_metric": "max_interface_device",
                        "notes": "인터페이스 수가 가장 많은 장비"
                    },
                    {
                        "goal": "aggregation",
                        "targets": ["GLOBAL"],
                        "primary_metric": "max_bgp_peer_device",
                        "notes": "BGP 피어가 가장 많은 장비"
                    },
                    {
                        "goal": "aggregation",
                        "targets": ["GLOBAL"],
                        "primary_metric": "all_devices_same_as",
                        "notes": "모든 장비가 같은 AS에 속하는지 확인"
                    },
                    {
                        "goal": "aggregation",
                        "targets": ["GLOBAL"],
                        "primary_metric": "min_interface_device",
                        "notes": "인터페이스 수가 가장 적은 장비"
                    },
                    {
                        "goal": "aggregation",
                        "targets": ["GLOBAL"],
                        "primary_metric": "bgp_as_distribution",
                        "notes": "각 AS별 장비 수 분포"
                    },
                    {
                        "goal": "aggregation",
                        "targets": ["GLOBAL"],
                        "primary_metric": "vrf_usage_statistics",
                        "notes": "장비별 VRF 사용 통계"
                    }
                ]
            }
        },
        {
            "category": "Reachability_Analysis",
            "description": "네트워크 도달성 분석 (Batfish 필요) - 학술적 근거: HSA(NSDI'12), VeriFlow(NSDI'13), Minesweeper(SIGCOMM'17)",
            "levels": {
                "L4": [
                    {
                        "goal": "reachability",
                        "targets": ["FLOW"],
                        "primary_metric": "traceroute_path",
                        "notes": "Batfish bf.q.traceroute() 사용",
                        "academic_reference": "Batfish (NSDI'15)"
                    },
                    {
                        "goal": "reachability",
                        "targets": ["FLOW"],
                        "primary_metric": "reachability_status",
                        "notes": "A→B 도달 가능 여부 확인",
                        "academic_reference": "HSA (NSDI'12), VeriFlow (NSDI'13)"
                    },
                    {
                        "goal": "reachability",
                        "targets": ["FLOW"],
                        "primary_metric": "acl_blocking_point",
                        "notes": "ACL에 의한 트래픽 차단 지점 식별",
                        "academic_reference": "HSA (NSDI'12)"
                    },
                    {
                        "goal": "invariant",
                        "targets": ["GLOBAL"],
                        "primary_metric": "loop_detection",
                        "notes": "포워딩 루프 탐지 - loop-free invariant",
                        "academic_reference": "HSA (NSDI'12), VeriFlow (NSDI'13)"
                    },
                    {
                        "goal": "invariant",
                        "targets": ["GLOBAL"],
                        "primary_metric": "blackhole_detection",
                        "notes": "블랙홀 탐지 - 패킷 드랍 지점",
                        "academic_reference": "HSA (NSDI'12), Minesweeper (SIGCOMM'17)"
                    },
                    {
                        "goal": "policy",
                        "targets": ["FLOW"],
                        "primary_metric": "waypoint_check",
                        "notes": "웨이포인트 통과 검증 (FW, IDS 등)",
                        "academic_reference": "Minesweeper (SIGCOMM'17), Config2Spec (NSDI'20)"
                    },
                    {
                        "goal": "policy",
                        "targets": ["FLOW"],
                        "primary_metric": "bounded_path_length",
                        "notes": "경로 홉 수 제한 검증",
                        "academic_reference": "Minesweeper (SIGCOMM'17)"
                    },
                    {
                        "goal": "isolation",
                        "targets": ["VRF_PAIR"],
                        "primary_metric": "isolation_check",
                        "notes": "VRF/테넌트 간 격리 검증",
                        "academic_reference": "HSA (NSDI'12), Config2Spec (NSDI'20)"
                    }
                ]
            }
        },
        {
            "category": "What_If_Analysis",
            "description": "What-If / Differential 분석 (Batfish 필요) - 학술적 근거: DNA(NSDI'22), Minesweeper(SIGCOMM'17)",
            "levels": {
                "L5": [
                    {
                        "goal": "what_if",
                        "targets": ["LINK_FAILURE"],
                        "primary_metric": "link_failure_impact",
                        "notes": "단일 링크 장애 영향 분석",
                        "academic_reference": "DNA (NSDI'22), Minesweeper (SIGCOMM'17)"
                    },
                    {
                        "goal": "fault_tolerance",
                        "targets": ["NODE_PAIR"],
                        "primary_metric": "k_failure_tolerance",
                        "notes": "k개 장애 내성 검증 (1-failure tolerance)",
                        "academic_reference": "Minesweeper (SIGCOMM'17), Trailblazer (FM'23)"
                    },
                    {
                        "goal": "differential",
                        "targets": ["CONFIG_CHANGE"],
                        "primary_metric": "config_change_impact",
                        "notes": "설정 변경 전후 비교 분석",
                        "academic_reference": "DNA (NSDI'22)"
                    },
                    {
                        "goal": "differential",
                        "targets": ["FLOW"],
                        "primary_metric": "differential_reachability",
                        "notes": "변경 전후 도달성 차이 분석",
                        "academic_reference": "DNA (NSDI'22)"
                    },
                    {
                        "goal": "compliance",
                        "targets": ["POLICY"],
                        "primary_metric": "policy_compliance_check",
                        "notes": "네트워크 정책 준수 검증 (waypoint 등)",
                        "academic_reference": "Config2Spec (NSDI'20)"
                    }
                ]
            }
        }
    ]
}
